

<div class="border rounded shadow px-5 pb-5 pt-2 min-vh-75 bg-med-yellow">

  <div class="row bg-light border shadow rounded-pill my-3 p-4">
    <div class="col-4">
      <div class="d-flex dropdown">
        <button class="btn btn-warning rounded-pill dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
            Selected Accounts
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <li *ngFor="let account of dbAccounts">
              <div class="dropdown-item" (click)="$event.stopPropagation()" (click)="toggleAccounts(account)">
                  <input type="checkbox" checked id="{{account}}" value="{{account}}">
                  <label class="ps-2" for="{{account}}" style="user-select: none;">{{ account }}</label>
              </div>
            </li>
        </ul>
    </div>
    </div>
    <div class="col-4">
      
    </div>
    <div class="col-4 d-flex">
      <div class="d-flex dropdown ms-auto me-1">
        <button class="btn btn-dark ms-auto" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
            Filter Categories
            <i class="bi bi-filter-square-fill"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <li *ngFor="let category of dbCategories">
              <div class="dropdown-item" (click)="$event.stopPropagation()" (click)="toggleCategoryBlacklist(category)">
                  <input type="checkbox" id="{{category}}Blacklist" value="{{category}}Blacklist">
                  <label class="ps-2" for="{{category}}Blacklist" style="user-select: none;">{{ category }}</label>
              </div>
            </li>
        </ul>
      </div>
      <div class="d-flex dropdown">
        <button class="btn btn-dark ms-auto" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
            Blacklist Categories
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <li *ngFor="let category of dbCategories">
              <div class="dropdown-item" (click)="$event.stopPropagation()" (click)="toggleCategoryBlacklist(category)">
                  <input type="checkbox" id="{{category}}Blacklist" value="{{category}}Blacklist">
                  <label class="ps-2" for="{{category}}Blacklist" style="user-select: none;">{{ category }}</label>
              </div>
            </li>
        </ul>
      </div>
    </div>
  </div>
  
  <div class="row pb-3">
    <div class="col-12">
      <div class="border bg-light rounded shadow py-2">
        <div class="bg-dark rounded-pill py-2 px-3 ms-auto me-4" style="width: 10%;">
          <select class="form-select bg-light-yellow" id="">
            <option value="">1 Year</option>
            <option value="">6 months</option>
            <option value="">Quarter</option>
          </select>
        </div>
        <div class="mx-auto" id="overtimeChart" style="width: 98%; height: 350px;"></div>
      </div>
    </div>
  </div>

  <div class="row gy-3 d-flex align-items-stretch">
    <!-- Mon Dropdown -->
    <div class="col-4 d-flex align-items-center justify-content-center">
      <div class="d-flex border bg-light rounded shadow py-3 w-100 h-100 align-items-center justify-content-center">
        <div class="w-75 mx-auto">
          <h6 class="text-center">
            Analytics for:
          </h6>
          <select class="form-select text-start"
                  (click)="displayAnalytics = true"
                  (change)="updateMonth()"
                  [(ngModel)]="selectedMonth"
                  id="yyyymmSelect">
            <option *ngFor="let yyyymm of selectedYyyymm.reverse()" value="{{yyyymm}}">{{yyyymm | monYear}}</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Month Title -->
    <div class="col-4 d-flex align-items-center justify-content-center">
      <div class="d-flex border bg-light rounded shadow py-3 w-100 h-100 align-items-center justify-content-center">
        <h2 class="text-center">
          {{ selectedMonth | monYear }}
        </h2>
      </div>
    </div>

    <!-- Curr Mon Total -->
    <div class="col-2 d-flex align-items-center justify-content-center">
      <div class="border bg-light rounded shadow py-3 w-100">
        <h6 class="text-center">
          Month Total
        </h6>
        <h4 class="text-center">
          {{ selectedMonthTotal | currency }}
        </h4>
        <h6 class="text-center">
          <span [ngClass]="momKpi > 0? 'text-success' : 'text-danger'">
            {{ momKpi | percent}},
          </span>
           {{ previousMonthTotal | currency }}
        </h6>
      </div>
    </div>

    <!-- Prev Mon Total -->
    <div class="col-2 d-flex align-items-center justify-content-center">
      <div class="d-flex flex-column border bg-light rounded shadow py-3 w-100 h-100 align-items-center justify-content-center">
        <div>
          <h6 class="text-center">
            Average Month Total
          </h6>
        </div>
        <div>
          <h4 class="text-center">
            {{ averageMonthlyTotal | currency }}
          </h4>
        </div>
      </div>
    </div>
    
    <!-- Month Bar Chart -->
    <div class="col-6" >
      <div class="border bg-light rounded shadow py-2">
        <div class="mx-2" id="monthChart" style="width: 98%; height: 400px;"></div>
      </div>
    </div>
      
    <!-- Month Transaction Table -->
    <div class="col-6">
      <div class="border bg-light rounded shadow p-2">
          <div class="table-scrollable">
            <table class="table table-striped table-light pt-1" style="height: 400px;">
              <thead>
                <tr>
                  <th><span>
                    Transaction Name 
                  </span></th>
                  <th>Amount</th>
                  <th>
                    <div class="dropdown">
                      Category
                      <i class="bi bi-filter-square-fill text-dark"
                          id="dropdownIcon" 
                          data-bs-toggle="dropdown" 
                          aria-expanded="false"
                          style="cursor: pointer;"></i>

                      <!-- Dropdown menu -->
                      <ul class="dropdown-menu" aria-labelledby="dropdownIcon">
                        <li>
                          <div class="dropdown-item" (click)="$event.stopPropagation()">
                            <input type="checkbox" id="option1" value="option1">
                            <label for="option1">Option 1</label>
                          </div>
                        </li>
                        <li>
                          <div class="dropdown-item" (click)="$event.stopPropagation()">
                            <input type="checkbox" id="option2" value="option2">
                            <label for="option2">Option 2</label>
                          </div>
                        </li>
                        <li>
                          <div class="dropdown-item" (click)="$event.stopPropagation()">
                            <input type="checkbox" id="option3" value="option3">
                            <label for="option3">Option 3</label>
                          </div>
                        </li>
                        <li>
                          <div class="dropdown-item" (click)="$event.stopPropagation()">
                            <input type="checkbox" id="option4" value="option4">
                            <label for="option4">Option 4</label>
                          </div>
                        </li>
                      </ul>
                          
                    </div>
                  </th>
                </tr>
            </thead>
              <tbody>
                  <tr *ngFor="let entry of monthTable">
                    <!-- Transaction Name -->
                    <td>
                      {{ entry.name }}
                    </td>
                    <!-- Amount -->
                    <td>
                      {{ entry.amount | currency }}
                    </td>
                    <!-- Category -->
                    <td>
                      <div class="d-flex">
                        <button class="btn btn-light-yellow" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                            {{ entry.category }}
                        </button>
                        <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                          <li>
                            <div class="dropdown-item bg-light-yellow" (click)="createCategoryButton(entry)">
                              <label class="ps-2">New Category</label>
                            </div>
                          </li>
                            <li *ngFor="let category of dbCategories">
                              <div class="dropdown-item" (click)="changeTransactionCategory(entry.name, category)">
                                  <label class="ps-2">{{ category }}</label>
                              </div>
                            </li>
                        </ul>
                      </div>
                    </td>
                  </tr>
              </tbody>
            </table>
          </div>
      </div>
    </div>
  </div>
  
</div>